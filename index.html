<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pomato Timer</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'%3e%3ccircle cx='25' cy='30' r='20' fill='%23ff6b6b'/%3e%3cellipse cx='25' cy='15' rx='3' ry='8' fill='%23228B22'/%3e%3c/svg%3e">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <h1>
            P<svg width="40" height="40" viewBox="0 0 50 50" style="margin:0; vertical-align: middle;">
                <circle cx="25" cy="30" r="20" fill="#ff6b6b"/>
                <ellipse cx="25" cy="15" rx="3" ry="8" fill="#228B22"/>
            </svg>mato Timer
        </h1>
    </header>
    <div id="app">
        <div v-if="loading" class="loading">
            <div class="spinner"></div>
            <p>Loading Pomato Timer...</p>
        </div>
        <main v-else>
        <main>
            <div class="tabs">
                <button @click="setMode('Work')" :class="{ active: currentMode === 'Work' }">Work</button>
                <button @click="setMode('Short Break')" :class="{ active: currentMode === 'Short Break' }">Short Break</button>
                <button @click="setMode('Long Break')" :class="{ active: currentMode === 'Long Break' }">Long Break</button>
            </div>
            <div class="timer">
                <div class="time-display">{{ formattedTime }}</div>
                <div class="status">{{ currentMode === 'Work' ? settings.title : currentMode }}</div>
                <div class="controls">
                    <button @click="startTimer" :disabled="isRunning">Start</button>
                    <button @click="pauseTimer" :disabled="!isRunning">Pause</button>
                    <button @click="resetTimer">Reset</button>
                </div>
            </div>
            <div class="settings">
                <button @click="showSettings = true" class="icon-btn">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                        <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L19 6.6C18.8 6 18.5 5.4 18.1 4.9L19 3L17 1L15.4 1.9C14.9 1.5 14.3 1.2 13.7 1L13 0H11L10.3 1C9.7 1.2 9.1 1.5 8.6 1.9L7 1L5 3L5.9 4.9C5.5 5.4 5.2 6 5 6.6L3 7V9L5 9.4C5.2 10 5.5 10.6 5.9 11.1L5 13L7 15L8.6 14.1C9.1 14.5 9.7 14.8 10.3 15L11 16H13L13.7 15C14.3 14.8 14.9 14.5 15.4 14.1L17 15L19 13L18.1 11.1C18.5 10.6 18.8 10 19 9.4L21 9ZM12 8C13.66 8 15 9.34 15 11C15 12.66 13.66 14 12 14C10.34 14 9 12.66 9 11C9 9.34 10.34 8 12 8Z"/>
                    </svg>
                </button>
                <button @click="showDashboardModal = true" class="icon-btn">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                        <path d="M5 3H19C20.1 3 21 3.9 21 5V19C21 20.1 20.1 21 19 21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3ZM7 17H9V13H7V17ZM11 17H13V7H11V17ZM15 17H17V10H15V17Z"/>
                    </svg>
                </button>
                <button @click="showLogViewer = true" class="icon-btn">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                        <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                        <path d="M9,13H15V15H9V13M9,9H15V11H9V9M9,17H13V19H9V17Z"/>
                    </svg>
                </button>
            </div>
        </main>
        <div v-if="showSettings" class="modal">
            <div class="modal-content">
                <h2>Settings</h2>
                <label>Title: <input v-model="settings.title" type="text"></label>
                <label>Work (mins): <input v-model.number="settings.work" type="number" min="1"></label>
                <label>Short Break (mins): <input v-model.number="settings.shortBreak" type="number" min="1"></label>
                <label>Long Break (mins): <input v-model.number="settings.longBreak" type="number" min="1"></label>
                <label>Auto Start: <input v-model="settings.autoStart" type="checkbox"></label>
                <label>Notifications: <input v-model="settings.notifications" type="checkbox"></label>
                <label>Sound: <input v-model="settings.sound" type="checkbox"></label>
                <button @click="saveSettings">Save</button>
                <button @click="showSettings = false">Cancel</button>
            </div>
        </div>
                <div v-if="showDashboardModal" class="modal">
            <div class="modal-content dashboard-modal">
                <h2>Dashboard</h2>
                <p>Total Sessions: {{ sessionCount }}</p>
                <p>Total Pomodoros: {{ completedPomodoros }}</p>
                <div class="progress-bar">
                    <div class="progress" :style="{width: progressPercent + '%'}"></div>
                    <span class="progress-text">{{ Math.round(progressPercent) }}% Complete</span>
                </div>
                <div v-if="activities.length === 0" class="no-data">No sessions yet. Complete some pomodoros to see your progress!</div>
                <div v-else>
                    <h3>Daily Progress</h3>
                    <canvas id="lineChart"></canvas>
                    <h3>Session History</h3>
                    <canvas id="chart"></canvas>
                </div>
                <button @click="showDashboardModal = false" class="close-btn">Close</button>
            </div>
        </div>
        <div v-if="showLogViewer" class="modal">
            <div class="modal-content log-modal">
                <h2>Activity Logs</h2>
                <div v-if="activities.length === 0" class="no-data">No activities logged yet.</div>
                <div v-else class="log-list">
                    <div v-for="(activity, index) in activities.slice().reverse()" :key="index" class="log-entry">
                        <div class="log-header">
                            <strong>{{ activity.mode }}</strong>
                            <span v-if="activity.title"> - {{ activity.title }}</span>
                            <span class="log-status" :class="{ completed: activity.completed, paused: !activity.completed }">
                                {{ activity.completed ? 'Completed' : 'Paused' }}
                            </span>
                        </div>
                        <div class="log-details">
                            <span>Started: {{ new Date(activity.start).toLocaleString() }}</span>
                            <span v-if="activity.end">Ended: {{ new Date(activity.end).toLocaleString() }}</span>
                            <span>Duration: {{ Math.floor(activity.elapsed / 60) }}m {{ activity.elapsed % 60 }}s</span>
                        </div>
                    </div>
                </div>
                <button @click="showLogViewer = false" class="close-btn">Close</button>
            </div>
        </div>
    </div>
    <script src="lib/vue.global.js"></script>
    <script src="lib/chart.js"></script>
    <script src="js/app.js"></script>
</body>
</html>